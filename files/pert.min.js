let estimateRows=1,computeProjectChance=function(e,t,n){return e*t+n},fillOutTable=function(){for(let e=1;e<estimateRows;e++){10<estimateRows?(document.getElementById("variance"+e).style.visibility="visible",document.getElementById("conf"+e).style.visibility="visible"):estimateRows<=10&&(document.getElementById("variance"+e).style.visibility="hidden",document.getElementById("conf"+e).style.visibility="hidden");var t=document.getElementById("best"+e).value,n=document.getElementById("worst"+e).value,o=document.getElementById("avg"+e).value,a=document.getElementById("conf"+e).value;t&&n&&o&&(t=parseFloat(t),n=parseFloat(n),o=parseFloat(o),a=parseFloat(a),o<=t||n<=o||n<=t?alert("Best must be less than Average and Average must be less than Worst"):(document.getElementById("variance"+e).value=Math.pow((n-t)/a,2),document.getElementById("expected"+e).value=((t+3*o+2*n)/6).toFixed(4)))}};const computeTotalExpectedTime=function(){let t=0;for(let e=1;e<estimateRows;e++){var n=document.getElementById("expected"+e).value;n&&(t+=parseFloat(n))}return t},computeTotalStdDevUnder10=function(){let t=0,n=0;for(let e=1;e<estimateRows;e++){var o=document.getElementById("best"+e).value,a=document.getElementById("worst"+e).value;o&&a&&(t+=parseFloat(o),n+=parseFloat(a))}return(n-t)/6},computeTotalVariance=function(){let t=0;for(let e=1;e<estimateRows;e++){var n=document.getElementById("variance"+e).value;n&&(t+=parseFloat(n))}return t},printResults=function(e,t,n){let o=document.getElementById("results");o.innerHTML="<BR/><BR/>";let a;estimateRows<=10?a=e:10<estimateRows&&(a=t),o.innerHTML+="<p>Standard deviation: <b>"+a.toFixed(2)+"</b> </p> ";let l,i,c,s;l=n,10<estimateRows?(i=computeProjectChance(.67,t,n),c=computeProjectChance(1.28,t,n),s=computeProjectChance(2,t,n)):estimateRows<=10&&(i=computeProjectChance(.67,e,n),c=computeProjectChance(1.28,e,n),s=computeProjectChance(2,e,n)),o.innerHTML+="<p>Schedule 50% chance: <b>"+l.toFixed(2)+"</b> </p> ",o.innerHTML+="<p>Schedule 75% chance: <b>"+i.toFixed(2)+"</b> </p> ",o.innerHTML+="<p>Schedule 90% chance: <b>"+c.toFixed(2)+"</b> </p> ",o.innerHTML+="<p>Schedule 98% chance: <b>"+s.toFixed(2)+"</b> </p> "};let recomputePert=function(){fillOutTable();var e=computeTotalExpectedTime(),t=computeTotalStdDevUnder10(),n=Math.sqrt(computeTotalVariance());printResults(t,n,e)},removeLastRow=function(){if(!(estimateRows<=1)){let e=document.querySelector("#resp-table-body");e.removeChild(e.lastChild),e.removeChild(e.lastChild),estimateRows--,recomputePert()}},insertRow=function(){let e=document.querySelector("#resp-table-body");var t='<select onchange="recomputePert()" id="conf'+estimateRows+'">\n  <option value="6">Very confident (99.7%)</option>\n  <option value="3.3" selected>Confident (90%)</option>\n  <option value="2.6" >Rough estimate (70%)</option>\n  <option value="1.4">Uncertain (50%)</option>\n  <option value="0.77">Highly uncertain (30%)</option>\n</select>',t='<div class="resp-table-row">  <div class="table-body-cell">\n            <input type="text" onkeyup="this.value=this.value.replace(/[^\\d|.]/,\'\');;recomputePert()" id="best'+estimateRows+'" >\n        </div>\n <div class="table-body-cell">\n            <input type="text" onkeyup="this.value.replace(/[^\\d|.]/,\'\');recomputePert()" id="avg'+estimateRows+'" >\n        </div>\n <div class="table-body-cell">\n            <input type="text" onkeyup="this.value.replace(/[^\\d|.]/,\'\');recomputePert()" id="worst'+estimateRows+'" >\n        </div>\n <div class="table-body-cell">\n            <input type="text" readonly id="expected'+estimateRows+'" >\n        </div>\n <div class="table-body-cell">\n'+t+'\n        </div>\n <div class="table-body-cell">\n            <input type="text" readonly id="variance'+estimateRows+'" >\n        </div>\n</div> \r\n';e.insertAdjacentHTML("beforeend",t),estimateRows++,recomputePert()};document.addEventListener("DOMContentLoaded",function(){},!1);